# √âcoM√©t√©o

# Description

### Choix du Sujet

xxx 

### Objectifs
L‚Äôapplication a pour objectif de fournir des pr√©visions m√©t√©orologiques pour la France, tout en optimisant l'impact environnemental de l‚Äôacc√®s √† ces informations. Aujourd‚Äôhui, des services comme M√©t√©o France posent plusieurs d√©fis environnementaux et d‚Äôexp√©rience utilisateur, en particulier avec :
- La surutilisation des donn√©es m√©t√©orologiques en ligne.
- Un rafra√Æchissement automatique tr√®s fr√©quent (parfois toutes les 30 secondes).
- Trop de publicit√©s intrusives, d√©gradant l‚Äôexp√©rience utilisateur.
- Une surcharge d‚Äôinformations jug√©es peu essentielles (exemple : articles, m√©t√©o de la France, m√©t√©o sur 15 jours).

# Choix du sujet
Les sites et applications m√©t√©o figurent parmi les plateformes num√©riques les plus consult√©es dans le monde. Ces services mobilisent d'importantes infrastructures, telles que des centres de donn√©es, pour offrir des pr√©visions en temps r√©el et des fonctionnalit√©s avanc√©es. Ce mod√®le, bien que pratique, contribue √† une empreinte √©cologique non n√©gligeable, notamment en raison de la consommation √©nerg√©tique n√©cessaire pour la collecte, le traitement et la diffusion des donn√©es m√©t√©orologiques.

Ainsi, il m'a sembl√© pertinent de concevoir une alternative plus respectueuse de l'environnement. Le projet vise √† d√©velopper une application web m√©t√©o all√©g√©e, optimis√©e pour limiter la surutilisation des donn√©es, r√©duire la fr√©quence de rafra√Æchissement, et √©viter les publicit√©s √©nergivores, tout en offrant une exp√©rience utilisateur fluide et agr√©able.

# Utilit√© sociale
Un service de pr√©visions m√©t√©orologiques joue un r√¥le central dans de nombreux aspects de la vie quotidienne et collective. Il constitue une ressource essentielle pour :

- La s√©curit√© des individus : En alertant sur des ph√©nom√®nes m√©t√©orologiques extr√™mes (temp√™tes, canicules, inondations), il permet aux populations de se pr√©parer et de r√©duire les risques pour leur vie et leurs biens.
- La planification des activit√©s : Que ce soit pour les agriculteurs, les voyageurs, ou les organisateurs d'√©v√©nements, les pr√©visions m√©t√©o permettent d'adapter les d√©cisions et de maximiser l'efficacit√©.
- La sant√© publique : Les alertes sur les √©pisodes de pollution ou de chaleur extr√™me sont indispensables pour pr√©venir des probl√®mes de sant√©, en particulier pour les populations vuln√©rables.
- La gestion des ressources : Dans des secteurs comme l‚Äôagriculture ou l‚Äô√©nergie renouvelable, la m√©t√©o influence les d√©cisions de production et d‚Äôutilisation des ressources, contribuant √† une gestion plus durable.
- La vie sociale et culturelle : Les pr√©visions facilitent √©galement l‚Äôorganisation des loisirs et des d√©placements, √©l√©ments cruciaux du bien-√™tre et de la coh√©sion sociale.

# Impact de la num√©risation
La num√©risation a profond√©ment transform√© les comportements de consultation des pr√©visions m√©t√©orologiques. L√† o√π la m√©t√©o √©tait traditionnellement diffus√©e via la presse √©crite, la t√©l√©vision ou la radio, elle est d√©sormais accessible instantan√©ment, √† tout moment et en tout lieu, gr√¢ce aux smartphones, ordinateurs et objets connect√©s. Cette √©volution soul√®ve plusieurs enjeux :

  - Substitution ou addition aux anciens moyens :
    - Si certains utilisateurs ont abandonn√© les supports traditionnels pour consulter la m√©t√©o exclusivement en ligne, d‚Äôautres continuent d‚Äôutiliser ces supports tout en int√©grant des consultations num√©riques. Ainsi, dans bien des cas, la num√©risation s‚Äôajoute aux pratiques existantes plut√¥t que de s‚Äôy substituer, augmentant globalement la consommation d‚Äô√©nergie li√©e √† la m√©t√©o.
    - Exemple: une personne peut regarder les pr√©visions √† la t√©l√©vision le matin, mais v√©rifier les mises √† jour plusieurs fois dans la journ√©e sur son smartphone.

  - Effet rebond :
    - La simplicit√© et la rapidit√© d‚Äôacc√®s aux pr√©visions via les outils num√©riques encouragent une consultation fr√©quente et parfois excessive. Ce ph√©nom√®ne entra√Æne une surconsommation de donn√©es et d‚Äô√©nergie.
    - Exemple : Alors que la consultation de la m√©t√©o via un journal ou une √©mission t√©l√©vis√©e se faisait une ou deux fois par jour, les utilisateurs d‚Äôapplications m√©t√©o consultent d√©sormais ces informations plusieurs fois par jour, voire par heure, m√™me en l‚Äôabsence de besoin r√©el.

  - Baisse ou hausse de l‚Äôimpact √©cologique par rapport aux moyens traditionnels :
    - Si l‚Äôacc√®s num√©rique peut sembler moins co√ªteux en ressources mat√©rielles que la presse √©crite (papier, encre, transport) ou la diffusion t√©l√©/radio (√©nergie des antennes et √©quipements), la r√©alit√© est plus     complexe. Les infrastructures num√©riques (centres de donn√©es, serveurs, r√©seaux) g√©n√®rent une empreinte √©nerg√©tique importante, souvent invisible pour l‚Äôutilisateur.
    - Par ailleurs, le caract√®re instantan√© et personnalisable des pr√©visions num√©riques alimente un usage intensif, ce qui limite le potentiel b√©n√©fice √©cologique par rapport aux anciens supports.

  - Notre solution face √† ces d√©fis :

    - Optimisation de la consommation √©nerg√©tique : En r√©duisant la fr√©quence de rafra√Æchissement des donn√©es (par exemple, toutes les 5 minutes au lieu de 30 secondes), ou en permettant √† l‚Äôutilisateur de choisir un rafra√Æchissement manuel, nous limitons l‚Äôimpact environnemental.
    - R√©duction des donn√©es affich√©es : En privil√©giant une interface minimaliste et centr√©e sur les informations essentielles, nous r√©duisons le transfert de donn√©es inutiles. Les informations secondaires restent disponibles √† la demande, mais leur affichage est restreint.
    - Pr√©visions √† court terme : En nous concentrant sur des pr√©visions fiables √† 3 jours maximum, nous limitons la surcharge des serveurs et la consommation √©nerg√©tique li√©e √† des calculs pour des p√©riodes plus longues, souvent moins pr√©cises.
    - Effet incitatif √† long terme : En r√©duisant la demande en donn√©es m√©t√©orologiques massives, notre solution pourrait inspirer d'autres d√©veloppeurs et fournisseurs d'API m√©t√©o √† adapter leurs pratiques, cr√©ant un effet positif √† l‚Äô√©chelle de l‚Äô√©cosyst√®me num√©rique. 

# Sc√©narios d'usage et impacts
Nous faisons l'hypoth√®se que les utilisateurs visitent notre plateforme plusieurs fois par jour, par exemple en milieu d'apr√®s-midi avant de sortir pour une activit√© en ext√©rieur ou avant de partir au travail, afin de v√©rifier les conditions m√©t√©orologiques actuelles et les pr√©visions √† venir. Ces visites peuvent durer quelques instants seulement. Pour cette raison, nous avons choisi de mod√©liser les sc√©narios suivants : l'un centr√© sur la consultation rapide de la m√©t√©o en temps r√©el, et l'autre sur l'exploration des pr√©visions √† long terme pour planifier des √©v√©nements futurs.

# Sc√©nario 1 Consultation de la m√©t√©o sur Paris et d'un article
  1. L'utilisateur se connecte √† M√©t√©o France ou √† un autre service m√©t√©o en ligne.
  2. Il s√©lectionne sa localisation (ville, r√©gion) ou laisse le site utiliser sa position g√©ographique.
  3. Il choisit de voir la m√©t√©o du weekend.

# Sc√©nario 2 Exploration des pr√©visions √† long terme
  1. L'utilisateur effectue √† nouveau les √©tapes 1, 2 et 3 du sc√©nario 1.
  2. Il consulte les pr√©visions √† court et moyen terme qui lui sont propos√©es en fonction de sa localisation.
  4. Les d√©tails complets des pr√©visions pour cette p√©riode (temp√©ratures, pr√©cipitations, vent, etc.) s'affichent.
  5. Il revient √† la liste des pr√©visions pour continuer son exploration ou consulter d'autres jours.

# Impact de l'ex√©cution des sc√©narios aupr√®s de diff√©rents services concurrents
L'EcoIndex d'une page (de A √† G) est calcul√© (sources : [EcoIndex](https://www.ecoindex.fr/), [GreenIT](https://github.com/cnumr/GreenIT-Analysis/tree/acc0334c712ba68939466c42af1514b5f448e19f)) en fonction du positionnement de cette page parmi les pages mondiales concernant :

  - le nombre de requ√™tes lanc√©es,
  - le poids des t√©l√©chargements,
  - le nombre d'√©l√©ments du document.

Nous avons choisi de comparer l'impact des sc√©narios sur diff√©rents services de m√©t√©o nationaux :

  - [analyse M√©t√©o France](./benchmark/greenit_analysis_extension/MeteoFrance_greenit.png),
  - [analyse La Cha√Æne M√©t√©o](./benchmark/greenit_analysis_extension/LaChaineMeteo_greenit.png),
  - [analyse M√©t√©oCiel](./benchmark/greenit_analysis_extension/MeteoCiel_greenit.png),
  - [analyse M√©t√©o60](./benchmark/greenit_analysis_extension/Meteo60_greenit.png).

Ayant eu des probl√®mes avec l'utilisation de greenit et des sc√©narios, par soucis de clart√© nous avons d√©cid√© d'utiliser uniquement l'extensions Google Chrome de greenit pour chacun des services m√©t√©o.
L'analyse est port√© sur la page principale de chacun des sites.

### ce qu'on retiens des analyses

# Maquette de l'interface et √©chantillon de donn√©es

Au vu des diff√©rents services compar√©s, des exigences environnementales exprim√©es plus haut et des sc√©narios retenus, nous avons d√©fini pour notre prototype une maquette de l'interface et un √©chantillon de donn√©es r√©alistes.

L'interface retenue est compos√©e d'une seule "page Web".
On y retrouve le header avec le nom du site et un formulaire permettant de choisir la ville. Une partie principale o√π l'on pourra observer les pr√©visions m√©t√©o. Et enfin, un menu qui permet de choisir le jour que l'on souhaite observer. (cf. Fig. 1)

![image](./frontend/mockup.png)
__Fig.1 :__ maquette de l'interface du prototype

Pour des raisons de respect des droits d'auteurs, nous utilisons des donn√©es g√©n√©r√©es (avec dummy-json). Bien que fictives, ces donn√©es correspondent √† la structure des services concurrents.
Nous avons donc g√©n√©r√© la m√©t√©o sur 7 jours pour 3 villes dif√©rentes.
Le format des donn√©es est inspir√© de celle d'API que nous avons pu trouver, les villes remplacent les stations m√©t√©o.

Ainsi, pour chaques jours, nous avons :

  - temp√©rature, 
  - taux d'humidit√©, 
  - vent, 
  - pr√©cipitation.


# Prototype n¬∞1 : Fonctionnalit√©s pour le sc√©nario prioritaire avec donn√©es statiques

Pour cette premi√®re version du prototype :

  - l'√©chantillon de donn√©es est encore charg√© dans le code de mani√®re statique,
  - les fonctionnalit√©s impl√©ment√©es ne sont que celles n√©cessaires pour suivre le sc√©nario prioritaire ("Regarder la m√©t√©o sur Paris").
Ce sc√©nario n√©cessite de pouvoir charger la page principale et regarder la m√©t√©o sur Paris.

## Page M√©t√©o

Nous avons d√©velopp√© la page m√©t√©o (cf. Fig. 2) pour qu'elle affiche l'√©chantillon de donn√©es sous une forme proche de ce que pr√©voyait la maquette.

![image](./frontend/mainPage_screenshot.png)
__Fig.2:__ Prototype de la page m√©t√©o

Pour l'instant, nous avons choisi un *framework* de mise en page minimaliste ([*PicoCSS*](https://picocss.com)).
Nous verrons si l'impact environnemental du passage √† un *framework* de mise en page plus puissant est significatif ou non.

Nous avons d√©cid√© pour l'instant de n'inclure aucune image ni design sp√©cifique (pas de style sur la page) pour l'affichage de la m√©t√©o. M√™me si ce style rend l'utilisation de la plupart des applications de pr√©visions m√©t√©o agr√©ablent, il est parfois inutile, apporte une polution visuelle et peu avoir un impact environnemental.
Dans les prochains prototypes, nous allons inclure des pictogrammes, de petits dessins souvent au format CSV qui sont tr√®s l√©gers et rendent l'utilisation d'un site beaucoup plus agr√©able.
√âgalement, les donn√©es statiques que nous utilisont ici sont uniquement les donn√©es importantes, nous n'avons pas encore vu la partie pour afficher des donn√©es suppl√©mentaires.
En fonction de l'utilit√© de ces derni√®res et de leurs impact nous les ajouterons ou non aux prototypes suivants.


Dans l'√©tat actuel du prototype, il est possible d'avoir une premi√®re id√©e de l'impact environnemental du *frontend*.
Bien entendu, il manque encore le chargement dynamique des donn√©es, mais nous pouvons d√©j√† √©valuer l'impact de l'affichage des donn√©es et du *framework* (au sens large : *React*, *PicoCSS*, *DayJS*).
Cette √©valuation de l'impact (cf. Tab.1) est d√©j√† encourageante en mode "d√©veloppement" mais encore plus en mode "pr√©-production".
Nous mesurons ici l'effet positif de l'adoption d'outils de d√©veloppement Web int√©grant la ["minification"](https://fr.wikipedia.org/wiki/Minification) (cf. *Wikip√©dia*) du code et la concat√©nation du code d'une part et des feuilles de style d'autre part.


|   | EcoIndex| GES (gCO2e) | Taille du DOM | Requ√™tes | Taille de la page (ko)
|---|--------:|------------:|--------------:|---------:|---------------------:
| Mode "d√©veloppement" | 82 Aüü¢ | 1,36 | 60 | 26 | 1678
| Mode "pr√©-production" | 94 Aüü¢ | 1,11 | 44 | 4 | 328

__Tab.1__: √âvaluation de l'impact du prototype de la page d'accueil.

Avec l'ajout de cette page, on peut tester un sc√©nario de consultation de la m√©t√©o et mesurer son impact.

|   | EcoIndex| GES (gCO2e) | Taille du DOM | Requ√™tes | Taille de la page (ko)
|---|--------:|------------:|--------------:|---------:|---------------------:
| 1. Consulter la page d'accueil | 95 Aüü¢ | 1,11 | 43 | 3 | 327
| 2. Choisir une ville | 95 Aüü¢ | 1,11 | 43 | 3 | 327
| 3. Choisir un jour | 95 Aüü¢ | 1,11 | 43 | 3 | 327

__Tab.2__: √âvaluation de l'impact du sc√©nario "consulter la m√©t√©o" dans le prototype n¬∞1.

Bien que ces estimation soient basses d√ª aux donn√©es statiques utilis√©es, elles nous permettent tout de m√™me de comparer avec celle des services concurrents vues pr√©c√©demment.

# Prototype n¬∞2 : Fonctionnalit√©s pour le sc√©nario prioritaire avec donn√©es statiques charg√©es de mani√®re dynamique

Pour cette deuxi√®me version du prototype, les donn√©es (toujours statiques) sont d√©sormais charg√©es par le frontend √† travers le r√©seau imm√©diatement apr√®s un premier affichage √† vide. Ce comportement, plus r√©aliste, n'a pour effet qu'une requ√™te suppl√©mentaire par page affich√©e.

Concernant l'√©valuation de l'impact environemental du sc√©nario, par rapport au tableau pr√©c√©dent (cf. Tab.2), √† l'exception du nombre de requ√™tes qui est incr√©ment√© de 1, les r√©sultats sont strictement identiques. D'ailleurs, √† partir de cette version, et √† moins de changements profonds, l'EcoIndex ne devrait plus √©voluer de mani√®re significative. Nous utiliserons d√©sormais un autre logiciel, GreenFrame, qui √©value non pas l'impact "environn√©" de la consultation (incorporant une participation au cycle de vie du terminal) mais celui de la consultation proprement dite (cf. Tab.3) et de mani√®re beaucoup plus fiable √† partir des statistiques d'utilisation des ressources physiques (CPU, m√©moire, r√©seau, disque).

|   | Impact de la consultation de la page (mg CO2e)
|-----------|-----:
| La Chaine M√©t√©o | 72 | 
| M√©t√©o60 | 88 |
| M√©t√©oCiel | 48 | 
| M√©t√©oFrance | 272 | 
| EcoMeteo | 32 |

Tab.3 : Impact de la consultation de la page principale des sites m√©t√©os concurrents (y compris notre service).

Pour les services existants, sur le graphique pr√©sentant l'utilisation dans le temps des ressources (cf. Fig.4), on constate d'autres pics que le pic initial, probablement associ√©s au chargement et √† l'affichage de contenus multim√©dias et de publicit√©s, ou caus√©s par des techniques de pistage sur le Web. De plus, l'utilisation CPU est extr√™mement forte.

![image](./benchmark/screenshots/GF_analys_MeteoFrance_overview.png)

Fig.4: Consommation de ressources lors de la consultation de la page M√©t√©oFrance.

Pour notre prototype, au contraire, le graphique (cf. Fig.5) pr√©sente un unique pic significatif de consommation de CPU et de r√©seau. Notons par ailleurs que le pic de CPU est 40 fois plus faible que celui de la figure pr√©c√©dente. Par ailleurs, nous remarquons que cette consommation ne compte que pour 4% de la consommation totale, le reste √©tant consomm√© par l'√©cran durant la dur√©e de la mesure.

![image](./benchmark/screenshots/GF_analys_EcoMeteo_overview.png)

Fig.5 : Consommation de ressources par le navigateur lors de la consultation de la page m√©t√©o dans notre prototype.

Par ailleurs, il nous est possible d√©sormais d'√©valuer l'impact √©cologique de la partie "serveur", possiblement h√©berg√©e par un data center (cf. Fig.6). R√©duite au simple h√©bergement de donn√©es statiques sur un serveur Web, cette partie a pour l'instant un impact tr√®s faible et quasi n√©gligeable (3%) par rapport √† la partie "client" .

![image](./benchmark/screenshots/GF_analys_EcoMeteo_network.png)

Fig.6 : Consommation de ressources par le serveur Web lors de la consultation de la page m√©t√©o dans notre prototype.

# Prototype n¬∞3 : Fonctionnalit√©s pour le sc√©nario prioritaire avec donn√©es stock√©es dans une base de donn√©es

Pour la troisi√®me version du prototype, les donn√©es sont d√©sormais stock√©es dans un syst√®me de base de donn√©es interrogeable √† travers une API Web (CouchDB). L'int√©r√™t d'une source de donn√©es dynamique est d'une part, √† terme, de pouvoir ajouter ou modifier des donn√©es plus facilement, et d'autre part de d√©porter sur le serveur le filtrage des donn√©es pertinentes.

Concernant ce deuxi√®me enjeu, contrairement au projet du professeur, notre prototype se limite √† une seule page. Ainsi, les mesures (cf. Fig.7) ne montrent pas de diminution de la charge r√©seau entre les deux prototypes pour la consultation de la page d'accueil.

![image](./benchmark/screenshots/GF_analys_EcoMeteo_Prototype2_overview.png)
![image](./benchmark/screenshots/GF_analys_EcoMeteo_Prototype3_overview.png)
Fig.7 : Comparaison de l'impact de la consultation de la page d'accueil entre les prototypes 2 (en haut) et 3 (en bas).

En revanche, nous avons maintenant une utilisation continue du CPU par la base de donn√©es (cf. Fig.8).
![image](./benchmark/screenshots/GF_analys_EcoMeteo_Prototype3_backend.png)

Fig.8 : Profil dans le temps de l'impact de la base de donn√©es lors de la consultation de la page d'accueil.

De ces diff√©rentes mesures, nous pouvons retenir que l'effet de l'introduction d'une base de donn√©es, quoique n√©gligeable, est, pour l'instant, plut√¥t d√©favorable d'un point de vue √©cologique. Le bilan de ce changement devrait cependant rapidement s'inverser avec l'augmentation de la quantit√© de donn√©es g√©r√©es.

# Prototype n¬∞4 : Fonctionnalit√©s pour le sc√©nario prioritaire avec filtrage des donn√©es

### Passage √† l'√©chelle

Dans notre cas, l'augmentation de la quantit√© de donn√©es √† traiter proviendra essentiellement du nombre de villes prises en compte ainsi que du nombre de dates. Pour simuler un volume important de donn√©es li√© √† une augmentation du nombre de villes, nous avons conserv√© les trois villes initialement s√©lectionn√©es (Toulouse, Paris, Troyes). Cependant, nous avons ajout√© un grand nombre de nouvelles dates. Cela reproduit l'effet de nombreuses villes avec quelques dates, tout en utilisant un nombre restreint de villes avec une multitude de dates. Cette approche nous permettra d'analyser les diff√©rences de performance de mani√®re efficace.

### √âvolution de l'impact environnemental avant correction

La figure 9 illustre l'impact du passage √† l'√©chelle, de 15 √† 9 000 fiches m√©t√©orologiques (une fiche correspondant √† une ville et une date). On observe, sur le backend, une multiplication par 5,8 de l'impact li√© au processeur et, surtout, une augmentation significative de l'impact r√©seau : une multiplication par 11 pour le frontend, ainsi qu'une explosion non quantifiable (de 0 √† 20 mWh) pour le backend.

![image](./benchmark/screenshots/GF_analys_EcoMeteo_huge_amout_data_overview.png)

Fig.9 : √âvolution de l'impact de la consultation de la page d'accueil en passant de 15 documents √† 9000.

### Prise en compte du passage √† l'√©chelle

Dans notre contexte, pour contrer les d√©fis li√©s √† la mise √† grande √©chelle, nous adopterons une strat√©gie visant √† limiter les donn√©es r√©cup√©r√©es √† celles strictement n√©cessaires au moment de la consultation.  

En effet, r√©cup√©rer toutes les donn√©es d√®s le d√©but, comme cela pourrait √™tre fait dans une application classique, entra√Ænerait une surcharge inutile du syst√®me et un impact environnemental accru. √Ä la place, nous mettrons en place un m√©canisme de requ√™tes cibl√©es, o√π les fiches m√©t√©o seront r√©cup√©r√©es en fonction de param√®tres sp√©cifiques : **la ville** et **la date**.  

Ainsi, au lieu de charger l'ensemble des donn√©es disponibles, nous demanderons uniquement les informations n√©cessaires pour la fiche m√©t√©o en cours de consultation. Ce fonctionnement nous permettra :  

1. De r√©duire le volume de donn√©es transf√©r√©es et trait√©es, optimisant ainsi les performances du syst√®me.  
2. D'offrir une exp√©rience utilisateur coh√©rente, sans ralentissement li√© √† la surcharge des ressources.  
3. De minimiser l'impact environnemental en adaptant la consommation d'√©nergie aux besoins r√©els de l'utilisateur.

Vous pourrez constater les am√©liorations r√©alis√©es gr√¢ce √† cette optimisation.

![image](./benchmark/screenshots/GF_analys_EcoMeteo_huge_amout_data_optimized_overview.png)

Fig.10 : √âvolution de l'impact de la consultation de la page d'accueil en ne r√©cup√©rant que les fiches m√©t√©o n√©cessaires.
